SELECT cast((verified.values::float / created.values::float) as numeric(10,4))
from

(SELECT COUNT(*) as values
FROM twmongodb.identities i
WHERE [verified_users]
AND [user_profile_completed]) verified,

(SELECT COUNT(distinct _id) as values
FROM twmongodb.identities
WHERE _type = 'User'
AND account_verified = 'true') created

---
with post_create as (
select project_id as id, created_at as created
from twmongodb.activities
where activity_type_cd in (0)
order by project_id, activity_type_cd),

post_complete as (
select project_id as id, created_at as completed
from twmongodb.activities
where activity_type_cd in (3)
order by project_id, activity_type_cd)

select p.project_type_display_name
, sum(datediff('s', post_create.created, post_complete.completed))/count(*)/3600 as average_time_hours
, sum(datediff('s', post_create.created, post_complete.completed))/count(*)/86400 as average_time_days
from twmongodb.projects p
join post_create on post_create.id = p._id
join post_complete on post_complete.id = p._id
group by p.project_type_display_name
order by average_time_hours DESC
