SELECT cast((verified.values::float / created.values::float) as numeric(10,4))
from

(SELECT COUNT(*) as values
FROM twmongodb.identities i
WHERE [verified_users]
AND [user_profile_completed]) verified,

(SELECT COUNT(distinct _id) as values
FROM twmongodb.identities
WHERE _type = 'User'
AND account_verified = 'true') created

---
with post_create as (
select project_id as id, created_at as created
from twmongodb.activities
where activity_type_cd in (0)
order by project_id, activity_type_cd),

post_complete as (
select project_id as id, created_at as completed
from twmongodb.activities
where activity_type_cd in (3)
order by project_id, activity_type_cd)

select p.project_type_display_name
, sum(datediff('s', post_create.created, post_complete.completed))/count(*)/3600 as average_time_hours
, sum(datediff('s', post_create.created, post_complete.completed))/count(*)/86400 as average_time_days
from twmongodb.projects p
join post_create on post_create.id = p._id
join post_complete on post_complete.id = p._id
group by p.project_type_display_name
order by average_time_hours DESC
----
with post_complete as (
  SELECT count(_id) as values, creator_id
  FROM twmongodb.projects p
  WHERE p.is_posted = true AND p.status_cd >= 3 AND p.status_cd < 8
  group by creator_id)

select case when (post_complete.values <= 5) then 'a:  5 or less'
  when (post_complete.values > 5)  and (post_complete.values <= 10) then 'b:  5 - 10'
  when (post_complete.values > 10) and (post_complete.values <= 25) then 'c:  10 - 25'
  when (post_complete.values > 25) and (post_complete.values <= 50) then 'd:  25 - 50'
  when (post_complete.values > 50) and (post_complete.values <= 100) then 'e:  50 - 100'
else 'f:  greater than 100'
end as how_many, count(creator_id)
from post_complete
group by post_complete.values
order by how_many
---
SELECT [created_at:week] AS week_created, COUNT(distinct _id) as new_users
FROM twmongodb.identities
WHERE _type = 'User'
AND account_verified = 'true'
group by 1
order by week_created
